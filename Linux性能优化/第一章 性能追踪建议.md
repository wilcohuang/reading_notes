
概要：

    第一章主要说的是，为了避免重复工作，避免收集错误信息，以及为自己的性能优化研究创建参考文档，所有的性能优化过程需要记录下来。
    
# 1.1 常用建议

## 1.1.1 记大量的笔记

性能优化之初，我们创建一个目录，将所有重要的内容保存：
    
- 记录硬/软件配置情况 （包括主存容量、CPU类型，网络和磁盘子系统）和软件环境（OS和软件的版本、相关的配置文件）。
      示例：每次测试时，保存cat /proc/pci、dmesg和uname -a的输出
      
- 保存并组织性能结果 笔记按照时间排序 
- 记录下命令行调用
- 记录研究信息和url 比如网页资料信息
    
定期回顾自己的笔记，有时候可以得到新的想法！




## 1.1.2 自动执行重复任务

    
- 性能工具调用   （记录下来，或者脚本实现）
- 应用程序测试   （脚本化）
    
    
## 1.1.3 尽可能选择低开销工具

因为高开销的工具会影响系统的行为！！！  

比如大名鼎鼎的valgrind，或者memprof（这个还没用过），这两个工具消耗的主存和CPU资源比原始应用程序要大，因此会改变系统行为。


## 1.1.4 使用多个工具来搞清楚问题

比如一个工具告诉系统使用大量磁盘I/O，另一个工具则告诉你系统使用了大量的交换。。。 所以，要多方面看问题

## 1.1.5 相信你的工具

不要认为你的工具坏了。。。 （我好像大三在校的时候使用valgrind测内存泄露，曾经怀疑过它）

## 1.1.6 利用他人的检验

简而言之，多Google

#1.2 性能调查概要

## 1.2.1 找到指标、基线和目标

设定一个性能目标，就知道何时应该停止优化，如果系统已经到性能瓶颈，那么就别死磕了！

## 1.2.1.1 确定指标

比如优化web服务器，可以优化“每秒服务的web请求数”。如果没有客观途径来度量性能，那么无法确定自己是否取得了进展。

## 1.2.1.2 确定基线 

确定基线。 调整和又花钱，运行应用程序并记录性能，这就是基线值，即性能调查的起点。

## 1.2.1.3 确定目标

1. 寻找其他有相同配置的人，询问他们的性能指标
2. 查找工业标准测试程序的结果
3. 在不同的OS或应用程序上使用你的硬件

## 1.2.2 追踪近似问题

相当于总结

## 1.2.3 查看问题是否早已解决

## 1.2.4 项目开始（启动调查）

- 分离问题  —— 删除其他多余程序，避免干扰
- 利用系统差异发现原因  —— 如果一个相似的系统具有更好的性能，那么就可以在这两个系统上运行同样的工具，比较结果，根据差异找原因
- 一次只改变一件事    —— 一次只改变一个点，这样如果改变改点改善了性能，那么直接就确定了解决方法
- 始终在优化后重新测量  ——  如果修改了系统，对调整后也要重新测量。因为有可能优化了老问题，引发新问题

## 1.2.5 记录，记录，记录

全记下来，供后续复用


 



